import pandas as pd

print('Imports complete.')

path = '../../malware_dataset/'
df = pd.read_csv(path + 'full_features_full_data.csv')

# Initialize the random_state for later use
random_state=1

df.head()

# Define our target variable
dep_var = 'Label'
df[dep_var].value_counts()

# The lowest amount of data is SMSMALWARE at 229,275 samples (or it's close enough)
low_count = 229275

# Pull out all of the samples into separate dataframes
# Benign data
benign_data = ( df.loc[ df[dep_var] == 'BENIGN']).sample(low_count, random_state=random_state)
print(benign_data[dep_var].value_counts())

# Adware data
adware_data = ( df.loc[ df[dep_var] == 'ADWARE']).sample(low_count, random_state=random_state)
print(adware_data[dep_var].value_counts())

# Scareware data
scareware_data = ( df.loc[ df[dep_var] == 'SCAREWARE']).sample(low_count, random_state=random_state)
print(scareware_data[dep_var].value_counts())

# Ransomware data
ransomware_data = ( df.loc[ df[dep_var] == 'RANSOMWARE']).sample(low_count, random_state=random_state)
print(ransomware_data[dep_var].value_counts())

# SMSMalware data
smsmalware_data = ( df.loc[ df[dep_var] == 'SMSMALWARE']).sample(low_count, random_state=random_state)
print(smsmalware_data[dep_var].value_counts())

# Write the data out to files
print('Creating Adware vs Benign file...', end='')
filen = 'adware_vs_benign.csv'
benign_data.to_csv(path + filen)
adware_data.to_csv(path + filen, mode='a', header=False)
print('done')

print('Creating Ransomware vs Benign file...', end='')
filen = 'ransomware_vs_benign.csv'
benign_data.to_csv(path + filen)
ransomware_data.to_csv(path + filen, mode='a', header=False)
print('done')

print('Creating Scareware vs Benign file...', end='')
filen = 'scareware_vs_benign.csv'
benign_data.to_csv(path + filen)
scareware_data.to_csv(path + filen, mode='a', header=False)
print('done')

print('Creating SMSmalware vs Benign file...', end='')
filen = 'smsmalware_vs_benign.csv'
benign_data.to_csv(path + filen)
smsmalware_data.to_csv(path + filen, mode='a', header=False)
print('done')

print('All datasets created! Exiting...')
